<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title></title>
<meta name="generator" content="Bluefish 1.0.7">
<meta name="author" content="Shulin">
<meta name="date" content="2010-11-26T00:34:21-0600">
<meta name="copyright" content="">
<meta name="keywords" content="">
<meta name="description" content="">
<meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8">
<meta http-equiv="content-style-type" content="text/css">
<meta http-equiv="expires" content="0">
<meta http-equiv="refresh" content="5; URL=http://">
<script type="text/javascript">
function sum(){
var f = document.getElementById("input1").value;
var s = document.getElementById("input2").value;
var sum = parseInt(f)+ parseInt(s);
document.getElementById("output").value = sum;
};

function computePower(){
var f = document.getElementById("input1").value;
var s = document.getElementById("input2").value;
var p = Math.pow(parseInt(f), parseInt(s));
document.getElementById("output").value = p;
};

function cr(){
var f = document.getElementById("input1").value;
var fArr = f.split(" ");
var s = document.getElementById("input2").value;
var sArr = s.split(" ");

if(fArr.length === sArr.length)
 {
 var n = fArr.length;
 var sumOfProducts = 0;//sum(x *y)
 var sumOfX=0;
 var sumOfY=0;
 var sumOfSquareX=0;
 var sumOfSquareY=0;
 for(var i=0; i < n; i++)
  {
   var x = parseFloat(fArr[i]);
   var y = parseFloat(sArr[i]);
   sumOfProducts += x*y;
   sumOfX += x;
   sumOfY += y;
   sumOfSquareX += x*x;
   sumOfSquareY += y*y;
  }
var base1 =(n*sumOfSquareX)-(sumOfX*sumOfX);
var base2 =(n*sumOfSquareY)-(sumOfY*sumOfY);
var result = ( n*sumOfProducts - sumOfX * sumOfY)/(Math.sqrt(base1*base2));
document.getElementById("output").value=result;
 }
 else {
 document.getElementById("output").value="Please input paired list of numbers in order do correlation computation!"
 }

};


function WriteFile() 
{
   var fso  = new ActiveXObject("Scripting.FileSystemObject"); 
   var fh = fso.CreateTextFile("\home\shulin\Desktop\Test.txt", true); 
   fh.WriteLine("Some text goes here..."); 
   fh.Close(); 
   alert("works!!");
};


</script>
</head>
<body>
<form>
<h3>This is an application to compute Pearson Correlation:</h3><br>
1st list of Number:<input type="text" id="input1" name="firstList"><br>
2nd list of Number:<input type="text" id="input2" name="secondList"><br>
<textarea rows="1" id="output" cols="50"></textarea><br>
<button name="compute" value="Compute" type="button" onclick="sum()">Sum</button>
<button name="power" value="Power" type="button" onclick="computePower()"> Power </button>
<button name="power" value="Power" type="button" onclick="cr()"> Correlation </button>
<button name="power" value="Power" type="button" onclick="clearRes()"> Reset </button><br>
<button onclick="WriteFile">Write File</button>
<i>Instruction:</i><br>
To compute correlation:<br>
Use space to delimit different number.<br>
For example:<br>
<pre>
1st list: 1 2 3 4 5 
2nd list: 2 3 4 5 6
result: 1</pre><br>
<pre>
1st list:1.23 2.34 3.54 4.01 5.34 6.23
2nd list:2 3 4 5 6 5.1
result: 0.9165227525254557

</pre> 
</form>
</body>
</html>